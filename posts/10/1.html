<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Iron&#39;s Blog | &#96;jQuery&#96;源码分析(一)：&#96;Core.js&#96;部分</title>
    <meta name="description" content="Just recording something">
    
    
    <link rel="preload" href="/assets/css/23.styles.40677ac6.css" as="style"><link rel="preload" href="/assets/js/app.0caf2975.js" as="script"><link rel="preload" href="/assets/js/20.725e2252.js" as="script"><link rel="prefetch" href="/assets/js/0.9f59e96c.js"><link rel="prefetch" href="/assets/js/1.9710c8e3.js"><link rel="prefetch" href="/assets/js/2.717bf58a.js"><link rel="prefetch" href="/assets/js/3.eb3ce0d5.js"><link rel="prefetch" href="/assets/js/4.81a9fd94.js"><link rel="prefetch" href="/assets/js/5.0289cb67.js"><link rel="prefetch" href="/assets/js/6.58a56d39.js"><link rel="prefetch" href="/assets/js/7.5fb1dc3c.js"><link rel="prefetch" href="/assets/js/8.af6cf755.js"><link rel="prefetch" href="/assets/js/9.d4b854ad.js"><link rel="prefetch" href="/assets/js/10.f94d82bf.js"><link rel="prefetch" href="/assets/js/11.68ad2dfd.js"><link rel="prefetch" href="/assets/js/12.fe4f1f96.js"><link rel="prefetch" href="/assets/js/13.1594182b.js"><link rel="prefetch" href="/assets/js/14.5e2158c7.js"><link rel="prefetch" href="/assets/js/15.cb7e4c09.js"><link rel="prefetch" href="/assets/js/16.637e1af2.js"><link rel="prefetch" href="/assets/js/17.c68f0f15.js"><link rel="prefetch" href="/assets/js/18.3f6c685d.js"><link rel="prefetch" href="/assets/js/19.5d57c2ad.js"><link rel="prefetch" href="/assets/js/21.c0d37235.js"><link rel="prefetch" href="/assets/js/22.c549c2ec.js">
    <link rel="stylesheet" href="/assets/css/23.styles.40677ac6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      Iron's Blog
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><!----></div></header><div class="sidebar-mask"></div><div class="sidebar"><!----><!----></div><div class="page"><div class="content"><h1 id="jquery源码分析-一-：core-js部分"><a href="#jquery源码分析-一-：core-js部分" aria-hidden="true" class="header-anchor">#</a><code>jQuery</code>源码分析(一)：<code>Core.js</code>部分</h1><h2 id="总体架构"><a href="#总体架构" aria-hidden="true" class="header-anchor">#</a> 总体架构</h2><p><code>Core</code>即核心，<code>jQuery</code>的核心部分主要做了这么几件事</p><ol><li>通过<code>require.js</code> 加载了var中的各个模块，获取了关于数组和对象的各种方法，比如<code>slice</code>, <code>concat</code>, <code>push</code>等，这样做使得jQuery对象的各类方法解耦，在模块中提供统一的接口，抹平浏览器之间的差异</li><li>定义一个jQuery函数并作为模块最后的返回值，这个jQuery函数调用时会调用<code>jQuery.fn.init</code>（这个<code>init</code>函数会在<code>/core/init.js</code>中实现）</li><li>添加一些数组和对象方法绑定到<code>jQuery</code>的<code>prototype</code>上。其中如<code>map</code>, <code>forEach</code>等方法会调用jQuery实例上的一些方法。这些实例上的方法会在第五条通过在后面的代码中调用<code>jQuery.extend</code>来添加</li><li>定义<code>jQuery.extend</code>,  主要是为了方便外部使用<code>jQuery.extend</code>来扩展jQuery，至于合并多个对象，这个功能是送的</li><li>调用<code>jQuery.extend</code>，将<code>require.js</code>加载的数组方法和对象添加到<code>jQuery</code>的实例上</li></ol><p><img src="/assets/img/1.889bbe76.png" alt></p><h2 id="代码部分"><a href="#代码部分" aria-hidden="true" class="header-anchor">#</a> 代码部分</h2><pre class="language-js"><code><span class="token comment">/* global Symbol */</span>
<span class="token comment">// Defining this global in .eslintrc.json would create a danger of using the global</span>
<span class="token comment">// unguarded in another place, it seems safer to define global only for this module</span>

<span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
	<span class="token string">&quot;./var/arr&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 对js原生数组的引用</span>
	<span class="token string">&quot;./var/document&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 对document对象的引用</span>
	<span class="token string">&quot;./var/getProto&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 对Object.getPrototypeOf的引用</span>
	<span class="token string">&quot;./var/slice&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 对Array.prototype.slice的引用</span>
	<span class="token string">&quot;./var/concat&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 对Array.prototype.concat的引用</span>
	<span class="token string">&quot;./var/push&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 对Array.prototype.push的引用</span>
	<span class="token string">&quot;./var/indexOf&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 对Array.prototype.indexOf的引用</span>
	<span class="token string">&quot;./var/class2type&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 一个对象(字典)，里面有类到类名的映射</span>
	<span class="token string">&quot;./var/toString&quot;</span> <span class="token comment">// Object.prototype.toString的引用</span>
	<span class="token string">&quot;./var/hasOwn&quot;</span><span class="token punctuation">,</span> <span class="token comment">// Object.prototype.hasOwnProperty的引用</span>
	<span class="token string">&quot;./var/fnToString&quot;</span><span class="token punctuation">,</span> <span class="token comment">// Function.prototype.toString的引用</span>
	<span class="token string">&quot;./var/ObjectFunctionString&quot;</span><span class="token punctuation">,</span> <span class="token comment">// Object构造函数调用toString()的结果。即`Object.toString()`</span>
	<span class="token string">&quot;./var/support&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 记录浏览器是否支持某种特性的一个对象，jQuery内部没有用到这个变量，但可能会有扩展jQuery的库需要他</span>
	<span class="token string">&quot;./var/isFunction&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 判断是否是函数(某些浏览器中会出现`typeof document.createElement( &quot;object&quot; ) === &quot;function`)的情况，因此做了兼容</span>
	<span class="token string">&quot;./var/isWindow&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 判断是否是window对象</span>
	<span class="token string">&quot;./core/DOMEval&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 这个`eval`的实现是把代码挂载到`&lt;script&gt;`标签中执行后删除`script`标签</span>
	<span class="token string">&quot;./core/toType&quot;</span> <span class="token comment">// 获得对象的类型</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>arr<span class="token punctuation">,</span> document<span class="token punctuation">,</span> getProto<span class="token punctuation">,</span> slice<span class="token punctuation">,</span> concat<span class="token punctuation">,</span> push<span class="token punctuation">,</span> indexOf<span class="token punctuation">,</span>
	class2type<span class="token punctuation">,</span> toString<span class="token punctuation">,</span> hasOwn<span class="token punctuation">,</span> fnToString<span class="token punctuation">,</span> ObjectFunctionString<span class="token punctuation">,</span>
	support<span class="token punctuation">,</span> isFunction<span class="token punctuation">,</span> isWindow<span class="token punctuation">,</span> DOMEval<span class="token punctuation">,</span> toType<span class="token punctuation">)</span> <span class="token punctuation">{</span>

		<span class="token string">&quot;use strict&quot;</span><span class="token punctuation">;</span>

		<span class="token keyword">var</span>
			version <span class="token operator">=</span> <span class="token string">&quot;3.3.1&quot;</span><span class="token punctuation">,</span>

			<span class="token comment">// Define a local copy of jQuery</span>
			<span class="token comment">// 定义jQuery函数</span>
			<span class="token function-variable function">jQuery</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>selector<span class="token punctuation">,</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>

				<span class="token comment">// The jQuery object is actually just the init constructor 'enhanced'</span>
				<span class="token comment">// Need init if jQuery is called (just allow error to be thrown if not included)</span>
				<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">jQuery<span class="token punctuation">.</span>fn<span class="token punctuation">.</span>init</span><span class="token punctuation">(</span>selector<span class="token punctuation">,</span> context<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>

			<span class="token comment">// Support: Android &lt;=4.0 only</span>
			<span class="token comment">// Make sure we trim BOM and NBSP</span>
			<span class="token comment">// 移除空格需要的正则表达式</span>
			rtrim <span class="token operator">=</span> <span class="token regex">/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g</span><span class="token punctuation">;</span>

		jQuery<span class="token punctuation">.</span>fn <span class="token operator">=</span> jQuery<span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>

			<span class="token comment">// The current version of jQuery being used</span>
			jquery<span class="token punctuation">:</span> version<span class="token punctuation">,</span>

			<span class="token comment">// 构造函数</span>
			constructor<span class="token punctuation">:</span> jQuery<span class="token punctuation">,</span>

			<span class="token comment">// The default length of a jQuery object is 0</span>
			length<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>

      <span class="token comment">// 把jQuery选择到的元素转化成数组</span>
			toArray<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">return</span> slice<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>

			<span class="token comment">// Get the Nth element in the matched element set OR</span>
      <span class="token comment">// Get the whole matched element set as a clean array</span>
      <span class="token comment">// 按照索引获取`jQuery`选择到的元素</span>
			<span class="token keyword">get</span><span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token punctuation">{</span>

				<span class="token comment">// Return all the elements in a clean array</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">return</span> slice<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>

				<span class="token comment">// Return just the one element from the set</span>
				<span class="token keyword">return</span> num <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token keyword">this</span><span class="token punctuation">[</span>num <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">[</span>num<span class="token punctuation">]</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>

			<span class="token comment">// Take an array of elements and push it onto the stack</span>
      <span class="token comment">// (returning the new matched element set)</span>
      <span class="token comment">// 返回一个新的元素加入到`jQuery`选择器选出的数组中的jQuery实例，他的`prevObject`指向merge之前的实例</span>
			pushStack<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>elems<span class="token punctuation">)</span> <span class="token punctuation">{</span>

				<span class="token comment">// Build a new jQuery matched element set</span>
				<span class="token comment">// 此处调用了`jQuery.merge`合并两个类数组的对象</span>
				<span class="token keyword">var</span> ret <span class="token operator">=</span> jQuery<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> elems<span class="token punctuation">)</span><span class="token punctuation">;</span>

				<span class="token comment">// Add the old object onto the stack (as a reference)</span>
				ret<span class="token punctuation">.</span>prevObject <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

				<span class="token comment">// Return the newly-formed element set</span>
				<span class="token keyword">return</span> ret<span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>

      <span class="token comment">// Execute a callback for every element in the matched set.</span>
      <span class="token comment">// each方法，会在下面通过`jQuery.extend`被加入到jQuery的实例上</span>
			each<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">return</span> jQuery<span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> callback<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>

      <span class="token comment">// 通过调用上面的pushStack方法将map后的数组重新组成一个jQUery的对象</span>
			map<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">pushStack</span><span class="token punctuation">(</span>jQuery<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>elem<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">return</span> callback<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>elem<span class="token punctuation">,</span> i<span class="token punctuation">,</span> elem<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>

      <span class="token comment">// 同上</span>
			slice<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">pushStack</span><span class="token punctuation">(</span>slice<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>

      <span class="token comment">// 返回第一个元素</span>
			first<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// 返回最后一个元素</span>
			last<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>

      <span class="token comment">// 返回某个index的元素，index为负数就从末尾往前找</span>
			eq<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">var</span> len <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>length<span class="token punctuation">,</span>
					j <span class="token operator">=</span> <span class="token operator">+</span>i <span class="token operator">+</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">?</span> len <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">pushStack</span><span class="token punctuation">(</span>j <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> j <span class="token operator">&lt;</span> len <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>

      <span class="token comment">// 结束当前链条最近的筛选操作</span>
			end<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>prevObject <span class="token operator">||</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>

			<span class="token comment">// For internal use only.</span>
      <span class="token comment">// Behaves like an Array's method, not like a jQuery method.</span>
      <span class="token comment">// 数组方法</span>
			push<span class="token punctuation">:</span> push<span class="token punctuation">,</span>
			sort<span class="token punctuation">:</span> arr<span class="token punctuation">.</span>sort<span class="token punctuation">,</span>
			splice<span class="token punctuation">:</span> arr<span class="token punctuation">.</span>splice
		<span class="token punctuation">}</span><span class="token punctuation">;</span>

		jQuery<span class="token punctuation">.</span>extend <span class="token operator">=</span> jQuery<span class="token punctuation">.</span>fn<span class="token punctuation">.</span><span class="token function-variable function">extend</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">var</span> options<span class="token punctuation">,</span> name<span class="token punctuation">,</span> src<span class="token punctuation">,</span> copy<span class="token punctuation">,</span> copyIsArray<span class="token punctuation">,</span> clone<span class="token punctuation">,</span>
				target <span class="token operator">=</span> arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
				<span class="token comment">// 正常情况下从为source `arguments[1]`到`arguments[length - 1]`</span>
				i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
				length <span class="token operator">=</span> arguments<span class="token punctuation">.</span>length<span class="token punctuation">,</span>
				deep <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

			<span class="token comment">// Handle a deep copy situation</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> target <span class="token operator">===</span> <span class="token string">&quot;boolean&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				deep <span class="token operator">=</span> target<span class="token punctuation">;</span>

				<span class="token comment">// Skip the boolean and the target</span>
				<span class="token comment">// 这种情况下从arguments[2]到arguments[length -1]为source</span>
				target <span class="token operator">=</span> arguments<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
				i<span class="token operator">++</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

      <span class="token comment">// Handle case when target is a string or something (possible in deep copy)</span>
      <span class="token comment">// 因为有那种类Object的Function，即绑定了字段的Function所以要排除这种情况</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> target <span class="token operator">!==</span> <span class="token string">&quot;object&quot;</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">isFunction</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				target <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

      <span class="token comment">// Extend jQuery itself if only one argument is passed</span>
      <span class="token comment">// 第一个参数不为boolean</span>
			<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">===</span> length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				target <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
				<span class="token comment">// 这种情况下为arguments[0]到argument[length - 1]为source，this为target</span>
				i<span class="token operator">--</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

				<span class="token comment">// Only deal with non-null/undefined values</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>options <span class="token operator">=</span> arguments<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

					<span class="token comment">// Extend the base object</span>
					<span class="token comment">// 如果传入的是数组，name就为Number</span>
					<span class="token keyword">for</span> <span class="token punctuation">(</span>name <span class="token keyword">in</span> options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
						src <span class="token operator">=</span> target<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// Target的[name]字段</span>
						copy <span class="token operator">=</span> options<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// source的[name]字段</span>

						<span class="token comment">// Prevent never-ending loop</span>
						<span class="token comment">// 两者相等直接跳过</span>
						<span class="token keyword">if</span> <span class="token punctuation">(</span>target <span class="token operator">===</span> copy<span class="token punctuation">)</span> <span class="token punctuation">{</span>
							<span class="token keyword">continue</span><span class="token punctuation">;</span>
						<span class="token punctuation">}</span>

						<span class="token comment">// Recurse if we're merging plain objects or arrays</span>
						<span class="token comment">// 如果是深拷贝且这个字段非nullish 且需要拷贝的字段类型是数组或plain object</span>
						<span class="token keyword">if</span> <span class="token punctuation">(</span>deep <span class="token operator">&amp;&amp;</span> copy <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>jQuery<span class="token punctuation">.</span><span class="token function">isPlainObject</span><span class="token punctuation">(</span>copy<span class="token punctuation">)</span> <span class="token operator">||</span>
							<span class="token punctuation">(</span>copyIsArray <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>copy<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

							<span class="token keyword">if</span> <span class="token punctuation">(</span>copyIsArray<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 需要拷贝的字段是数组</span>
								copyIsArray <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
								clone <span class="token operator">=</span> src <span class="token operator">&amp;&amp;</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span> <span class="token operator">?</span> src <span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

							<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// 需要拷贝的字段是对象</span>
								clone <span class="token operator">=</span> src <span class="token operator">&amp;&amp;</span> jQuery<span class="token punctuation">.</span><span class="token function">isPlainObject</span><span class="token punctuation">(</span>src<span class="token punctuation">)</span> <span class="token operator">?</span> src <span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
							<span class="token punctuation">}</span>

							<span class="token comment">// Never move original objects, clone them</span>
							<span class="token comment">// 递归深拷贝这个数组或plain object</span>
							target<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> jQuery<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span>deep<span class="token punctuation">,</span> clone<span class="token punctuation">,</span> copy<span class="token punctuation">)</span><span class="token punctuation">;</span>

							<span class="token comment">// Don't bring in undefined values</span>
						<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>copy <span class="token operator">!==</span> undefined<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 浅拷贝，过滤掉undefined的值</span>
							target<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> copy<span class="token punctuation">;</span>
						<span class="token punctuation">}</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>

			<span class="token comment">// Return the modified object</span>
			<span class="token keyword">return</span> target<span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">;</span>

		jQuery<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token punctuation">{</span>

			<span class="token comment">// Unique for each copy of jQuery on the page</span>
			expando<span class="token punctuation">:</span> <span class="token string">&quot;jQuery&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>version <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/\D/g</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

			<span class="token comment">// Assume jQuery is ready without the ready module</span>
			<span class="token comment">// jQuery的所有module是否都加载完毕的标志</span>
			isReady<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
			
		
			error<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>

			<span class="token comment">// 空函数</span>
			noop<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>

			<span class="token comment">// 判断是否是Plain object</span>
			isPlainObject<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">var</span> proto<span class="token punctuation">,</span> Ctor<span class="token punctuation">;</span>

				<span class="token comment">// Detect obvious negatives</span>
				<span class="token comment">// Use toString instead of jQuery.type to catch host objects</span>
				<span class="token comment">// 所有的PlainObject调用toString后都会返回`[object, object]`</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>obj <span class="token operator">||</span> toString<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token string">&quot;[object Object]&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>

				proto <span class="token operator">=</span> <span class="token function">getProto</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>

				<span class="token comment">// Objects with no prototype (e.g., `Object.create( null )`) are plain</span>
				<span class="token comment">// `Object.create(null)`返回的对象没有prototype</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>proto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>

				<span class="token comment">// Objects with prototype are plain iff they were constructed by a global Object function</span>
				Ctor <span class="token operator">=</span> hasOwn<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>proto<span class="token punctuation">,</span> <span class="token string">&quot;constructor&quot;</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> proto<span class="token punctuation">.</span>constructor<span class="token punctuation">;</span>
				<span class="token comment">// 通过比较构造函数的toString方法来看obj的原型是否是Object</span>
				<span class="token keyword">return</span> <span class="token keyword">typeof</span> Ctor <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span> <span class="token operator">&amp;&amp;</span> fnToString<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>Ctor<span class="token punctuation">)</span> <span class="token operator">===</span> ObjectFunctionString<span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>

			<span class="token comment">// 判断是否为空对象</span>
			isEmptyObject<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>

				<span class="token comment">/* eslint-disable no-unused-vars */</span>
				<span class="token comment">// See https://github.com/eslint/eslint/issues/6125</span>
				<span class="token keyword">var</span> name<span class="token punctuation">;</span>

				<span class="token keyword">for</span> <span class="token punctuation">(</span>name <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>

			<span class="token comment">// DOMEval的引用拷贝</span>
			<span class="token comment">// Evaluates a script in a global context</span>
			globalEval<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>code<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token function">DOMEval</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>

			<span class="token comment">// array.each函数绑定在jQuery对象上，上面的prototype通过调用它并传入this来实现`$('foo').each`</span>
			each<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>obj<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">var</span> length<span class="token punctuation">,</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isArrayLike</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">// 类数组</span>
					length <span class="token operator">=</span> obj<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
					<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token comment">// jQuery.each的callback的this指向当前循环的对象</span>
						<span class="token keyword">if</span> <span class="token punctuation">(</span>callback<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> obj<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
							<span class="token keyword">break</span><span class="token punctuation">;</span>
						<span class="token punctuation">}</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment">// 相当于obj.values()</span>
					<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token keyword">if</span> <span class="token punctuation">(</span>callback<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> obj<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
							<span class="token keyword">break</span><span class="token punctuation">;</span>
						<span class="token punctuation">}</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>

				<span class="token keyword">return</span> obj<span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>

			<span class="token comment">// Support: Android &lt;=4.0 only</span>
			<span class="token comment">// 兼容安卓4.0的trim</span>
			trim<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>text<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">return</span> text <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span>
					<span class="token string">&quot;&quot;</span> <span class="token punctuation">:</span>
					<span class="token punctuation">(</span>text <span class="token operator">+</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>rtrim<span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>

			<span class="token comment">// results is for internal usage only</span>
			makeArray<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>arr<span class="token punctuation">,</span> results<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">var</span> ret <span class="token operator">=</span> results <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

				<span class="token keyword">if</span> <span class="token punctuation">(</span>arr <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isArrayLike</span><span class="token punctuation">(</span><span class="token function">Object</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						jQuery<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span>ret<span class="token punctuation">,</span>
							<span class="token keyword">typeof</span> arr <span class="token operator">===</span> <span class="token string">&quot;string&quot;</span> <span class="token operator">?</span>
								<span class="token punctuation">[</span>arr<span class="token punctuation">]</span> <span class="token punctuation">:</span> arr
						<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
						push<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>ret<span class="token punctuation">,</span> arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>

				<span class="token keyword">return</span> ret<span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>

			inArray<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>elem<span class="token punctuation">,</span> arr<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">return</span> arr <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">:</span> indexOf<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> elem<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>

			<span class="token comment">// Support: Android &lt;=4.0 only, PhantomJS 1 only</span>
			<span class="token comment">// push.apply(_, arraylike) throws on ancient WebKit</span>
			<span class="token comment">// 合并2个数组</span>
			merge<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>first<span class="token punctuation">,</span> second<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">var</span> len <span class="token operator">=</span> <span class="token operator">+</span>second<span class="token punctuation">.</span>length<span class="token punctuation">,</span>
					j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
					i <span class="token operator">=</span> first<span class="token punctuation">.</span>length<span class="token punctuation">;</span>

				<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					first<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> <span class="token operator">=</span> second<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>

				first<span class="token punctuation">.</span>length <span class="token operator">=</span> i<span class="token punctuation">;</span>

				<span class="token keyword">return</span> first<span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>

			<span class="token comment">// 过滤数组</span>
			grep<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>elems<span class="token punctuation">,</span> callback<span class="token punctuation">,</span> invert<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">var</span> callbackInverse<span class="token punctuation">,</span>
					matches <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
					i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
					length <span class="token operator">=</span> elems<span class="token punctuation">.</span>length<span class="token punctuation">,</span>
					callbackExpect <span class="token operator">=</span> <span class="token operator">!</span>invert<span class="token punctuation">;</span>

				<span class="token comment">// Go through the array, only saving the items</span>
				<span class="token comment">// that pass the validator function</span>
				<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					callbackInverse <span class="token operator">=</span> <span class="token operator">!</span><span class="token function">callback</span><span class="token punctuation">(</span>elems<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token comment">// 若`invert === false，`callbackExcept`true`callback`返回`true`的元素会被加入到数组</span>
					<span class="token comment">// 若`invert === true`callbackExcept`为`false`，`callback`返回`false`的元素会被加入到数组</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span>callbackInverse <span class="token operator">!==</span> callbackExpect<span class="token punctuation">)</span> <span class="token punctuation">{</span>
						matches<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>elems<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>

				<span class="token keyword">return</span> matches<span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>

			<span class="token comment">// arg is for internal usage only</span>
			<span class="token comment">// map方法，`jQuery.prototype.map`通过调用这个来实现map</span>
			map<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>elems<span class="token punctuation">,</span> callback<span class="token punctuation">,</span> arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">var</span> length<span class="token punctuation">,</span> value<span class="token punctuation">,</span>
					i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
					ret <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

				<span class="token comment">// Go through the array, translating each of the items to their new values</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isArrayLike</span><span class="token punctuation">(</span>elems<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					length <span class="token operator">=</span> elems<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
					<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
						value <span class="token operator">=</span> <span class="token function">callback</span><span class="token punctuation">(</span>elems<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> arg<span class="token punctuation">)</span><span class="token punctuation">;</span>

						<span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
							ret<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token punctuation">}</span>
					<span class="token punctuation">}</span>

					<span class="token comment">// Go through every key on the object,</span>
					<span class="token comment">// 对象`map`的情况，`i`为对象的k`ey`</span>
				<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
					<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token keyword">in</span> elems<span class="token punctuation">)</span> <span class="token punctuation">{</span>
						value <span class="token operator">=</span> <span class="token function">callback</span><span class="token punctuation">(</span>elems<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> arg<span class="token punctuation">)</span><span class="token punctuation">;</span>

						<span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
							ret<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
						<span class="token punctuation">}</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>

				<span class="token comment">// Flatten any nested arrays</span>
				<span class="token keyword">return</span> concat<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> ret<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>

			<span class="token comment">// A global GUID counter for objects</span>
			<span class="token comment">// 全局`guid`代表`jQuery`对象</span>
			guid<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>

			<span class="token comment">// jQuery.support is not used in Core but other projects attach their</span>
			<span class="token comment">// properties to it so it needs to exist.</span>
			support<span class="token punctuation">:</span> support
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 如果有es6的`Symbol`将`Symbol`部署到`jQuery.fn`上。这样就可以使用for和数组扩展等符号</span>
		<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> Symbol <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			jQuery<span class="token punctuation">.</span>fn<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// Populate the class2type map</span>
		<span class="token comment">// 填充class2Type 的字典</span>
		jQuery<span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span><span class="token string">&quot;Boolean Number String Function Array Date RegExp Object Error Symbol&quot;</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
			<span class="token keyword">function</span> <span class="token punctuation">(</span>i<span class="token punctuation">,</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">// `Object.prototype.toString.call(foo)`会返回`[object ${typeof foo}]`</span>
				<span class="token comment">// toType中通过调用`Object.prototype.toString.call`来获得type的key</span>
				class2type<span class="token punctuation">[</span><span class="token string">&quot;[object &quot;</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">&quot;]&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> name<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 判断是否是类数组的对象</span>
		<span class="token keyword">function</span> <span class="token function">isArrayLike</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>

			<span class="token comment">// Support: real iOS 8.2 only (not reproducible in simulator)</span>
			<span class="token comment">// `in` check used to prevent JIT error (gh-2145)</span>
			<span class="token comment">// hasOwn isn't used here due to false negatives</span>
			<span class="token comment">// regarding Nodelist length in IE</span>
			<span class="token comment">// 使用`in`检查属性是否存在来避免iOS8.2的JIT错误</span>
			<span class="token comment">// IE下host object（`window`,` Nodelist`, `location`）等没有hasOwnProperty方法</span>
			<span class="token keyword">var</span> length <span class="token operator">=</span> <span class="token operator">!</span><span class="token operator">!</span>obj <span class="token operator">&amp;&amp;</span> <span class="token string">&quot;length&quot;</span> <span class="token keyword">in</span> obj <span class="token operator">&amp;&amp;</span> obj<span class="token punctuation">.</span>length<span class="token punctuation">,</span>
				type <span class="token operator">=</span> <span class="token function">toType</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>

			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isFunction</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">isWindow</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>

			<span class="token keyword">return</span> type <span class="token operator">===</span> <span class="token string">&quot;array&quot;</span> <span class="token operator">||</span> length <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">||</span>
				<span class="token keyword">typeof</span> length <span class="token operator">===</span> <span class="token string">&quot;number&quot;</span> <span class="token operator">&amp;&amp;</span> length <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">in</span> obj<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token keyword">return</span> jQuery<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><h2 id="参考资料"><a href="#参考资料" aria-hidden="true" class="header-anchor">#</a> 参考资料</h2><p><a href="https://github.com/jquery/jquery" target="_blank" rel="noopener noreferrer">jQuery github repo</a></p><p><a href="https://api.jquery.com/" target="_blank" rel="noopener noreferrer">jQuery API documentation</a></p></div><!----><!----></div></div></div>
    <script src="/assets/js/20.725e2252.js" defer></script><script src="/assets/js/app.0caf2975.js" defer></script>
  </body>
</html>
